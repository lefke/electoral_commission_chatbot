(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(3130)}])},3130:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Home}});var t=a(5893),l=a(7294),r=a(4080),i=a(1479);let Disclaimers=e=>{let{dark:s=!1}=e;return(0,t.jsxs)("ul",{className:"".concat(s?"text-white/70":"text-gray-500"," py-2 px-6 text-sm  list-disc "),children:[(0,t.jsx)("li",{children:"The answers provided are not legal advice"}),(0,t.jsx)("li",{children:"This is an experimental search tool"}),(0,t.jsx)("li",{className:"",children:"Seaching document versions from 02/10/2023"}),(0,t.jsx)("li",{children:"All data provided should be fact checked with The Electoral Commission tel: 0333 103 1928"})]})};function LoadingModal(){let[e,s]=(0,l.useState)(!0),[a,n]=(0,l.useState)(!1);return(0,t.jsx)(r.u,{appear:!0,show:e,as:l.Fragment,children:(0,t.jsxs)(i.V,{as:"div",className:"relative z-10",onClose:()=>{},children:[(0,t.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-200",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,t.jsx)("div",{className:"fixed inset-0 bg-black/25"})}),(0,t.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,t.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,t.jsx)(r.u.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,t.jsxs)(i.V.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-slate-200 p-0 text-ec-blue-900 text-left align-middle shadow-xl transition-all",children:[(0,t.jsx)(i.V.Title,{as:"h3",className:"text-lg text-center font-medium leading-6 px-6 pt-6 pb-3",children:"When decoding electoral guidance feels a bit like:"}),(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("div",{className:"px-6 pb-3 w-56 mx-auto",children:(0,t.jsx)("img",{src:"/work-working.gif","max-width":"200px",width:"100%",height:"100%"})}),(0,t.jsx)("h2",{className:"px-6 pb-3",children:"Ask the (unofficial) chat bot to do the searching for you"}),(0,t.jsxs)("div",{className:"bg-white p-6 pb-3",children:[(0,t.jsx)("h3",{className:" text-gray-500",children:"Disclaimers"}),(0,t.jsx)(Disclaimers,{}),(0,t.jsxs)("div",{className:"relative flex gap-x-3",children:[(0,t.jsx)("div",{className:"flex h-6 items-center",children:(0,t.jsx)("input",{id:"candidates",name:"candidates",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600",onClick:()=>n(!a)})}),(0,t.jsx)("div",{className:"text-sm leading-6",children:(0,t.jsx)("label",{htmlFor:"candidates",className:"font-medium text-gray-900",children:"I have read and acknowledge the disclaimers"})})]})]})]}),(0,t.jsx)("div",{className:"text-center bg-white p-6 pt-3",children:a?(0,t.jsx)("button",{type:"button",className:"inline-flex justify-center rounded-md border border-transparent bg-blue-100 px-4 py-2 font-medium text-blue-900 hover:bg-blue-200 focus:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2",onClick:()=>s(!1),disabled:!a,children:"Get started!"}):(0,t.jsx)("span",{className:"italic text-sm",children:"Please acknowledge disclaimers to get started"})})]})})})})]})})}var n=a(4149);let SidebarContent=()=>(0,t.jsxs)("div",{className:"flex flex-col h-full justify-between",children:[(0,t.jsx)(Title,{dark:!0}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"pt-3 text-white",children:"Disclaimer"}),(0,t.jsx)(Disclaimers,{dark:!0})]})]}),Title=e=>{let{dark:s=!1}=e;return(0,t.jsxs)("div",{className:"".concat(s?"text-white":"text-black"," flex flex-col pl-3 gap-0 lg:gap-3"),children:[(0,t.jsx)("div",{className:"pt-2",children:"The EC Doc (Unofficial) Chatbot Search"}),(0,t.jsxs)("div",{className:"text-xs pb-2",children:["A"," ",(0,t.jsx)("a",{className:"hover:text-gray-300 italic",href:"https://www.campaignlab.uk",children:"Campaign Lab"})," ","project"]})]})},Sidebar=e=>{let{children:s}=e,[a,r]=(0,l.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"lg:hidden border-y px-4 sm:px-6 md:px-8 flex justify-between",children:[(0,t.jsx)(Title,{}),(0,t.jsx)(SidebarToggle,{onToggle:()=>{r(!a)}})]}),(0,t.jsx)("div",{id:"application-sidebar",className:"fixed ".concat(a?"":"hidden lg:block w-0 lg:w-64"," top-0 start-0 bottom-0 lg:z-0 z-[20] w-64 bg-ec-blue-900 text-white border-e border-gray-200 pt-7 pb-10 overflow-y-auto end-auto [&::-webkit-scrollbar]:w-2 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-track]:bg-gray-100 [&::-webkit-scrollbar-thumb]:bg-gray-300 lg:block"),children:(0,t.jsx)("div",{className:"px-6 h-full",children:s})})]})},SidebarToggle=e=>{let{onToggle:s}=e;return(0,t.jsx)("div",{className:"flex items-center py-4",children:(0,t.jsxs)("button",{type:"button",className:"text-gray-500 hover:text-gray-600 lg:hidden","data-hs-overlay":"#application-sidebar","aria-controls":"application-sidebar","aria-label":"Toggle navigation",onClick:s,children:[(0,t.jsx)("span",{className:"sr-only",children:"Toggle Navigation"}),(0,t.jsx)(n.Z,{className:"flex-shrink-0 w-6 h-6"})]})})};function Layout(e){let{children:s}=e;return(0,t.jsxs)("div",{className:"bg-slate-200 text-ec-blue-900 h-screen flex flex-col",children:[(0,t.jsx)(Sidebar,{children:(0,t.jsx)(SidebarContent,{})}),(0,t.jsx)("main",{className:"w-full overflow-hidden flex sm:w-full bg-white flex-auto flex-col-reverse mt-0 p-0 justify-items-end lg:ps-64",children:s}),(0,t.jsx)(LoadingModal,{})]})}var o=a(6612),c=a.n(o),d=a(6145),x=a.n(d);let LoadingDots=e=>{let{color:s="#000",style:a="small"}=e;return(0,t.jsxs)("span",{className:"small"==a?x().loading2:x().loading,children:[(0,t.jsx)("span",{style:{backgroundColor:s}}),(0,t.jsx)("span",{style:{backgroundColor:s}}),(0,t.jsx)("span",{style:{backgroundColor:s}})]})};LoadingDots.defaultProps={style:"small"};let MessageInput=e=>{let{loading:s,setLoading:a,messageState:r,setMessageState:i}=e,[n,o]=(0,l.useState)(""),[d,x]=(0,l.useState)(null),[m,u]=(0,l.useState)(""),{history:h}=r;async function handleSubmit(e){if(e.preventDefault(),x(null),!n){alert("Please input a question");return}let s=n.trim();a(!0),o("");try{let e=await fetch("/api/chat/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:s,history:r.history,conversationId:m})}),a=await e.json();a.error?x(a.error):i(e=>({...e,messages:[...e.messages,{type:"userMessage",message:s},{type:"apiMessage",message:a.text,sourceDocs:a.sourceDocuments}],history:[...e.history,[s,a.text]]}))}catch(e){x("An error occurred while fetching the data. Please try again.")}finally{a(!1)}}(0,l.useEffect)(()=>{var e,s;let a=(e=new Date().getTime(),s=performance&&performance.now&&1e3*performance.now()||0,"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var t=16*Math.random();return e>0?(t=(e+t)%16|0,e=Math.floor(e/16)):(t=(s+t)%16|0,s=Math.floor(s/16)),("x"===a?t:3&t|8).toString(16)}));window.localStorage.setItem("conversationId",a),u(a)},[]),(0,l.useEffect)(()=>{setTimeout(()=>d&&x(null),2500)},[d]);let g=(0,l.useRef)(null);return(0,l.useEffect)(()=>{var e;null===(e=g.current)||void 0===e||e.focus()},[]),(0,t.jsxs)("div",{id:"input-center",className:"flex justify-center container align-center px-4 py-0 flex-col -order-1 mt-3 mb-2",children:[d&&(0,t.jsx)("div",{className:"border border-red-400 rounded-md p-4 mb-4",children:(0,t.jsx)("p",{className:"text-red-500",children:d})}),(0,t.jsxs)("div",{className:c().cloudform+" relative w-full",children:[(0,t.jsxs)("form",{onSubmit:handleSubmit,className:"relative w-full",children:[(0,t.jsx)("textarea",{disabled:s,onKeyDown:e=>{"Enter"===e.key&&n?handleSubmit(e):"Enter"==e.key&&e.preventDefault()},ref:g,autoFocus:!1,rows:1,maxLength:512,id:"userInput",name:"userInput",placeholder:s?"Waiting for response...":"Ask a question...",value:n,onChange:e=>o(e.target.value),className:c().textarea+" relative w-full"}),(0,t.jsx)("button",{type:"submit",disabled:s,className:"bottom-5 right-4 text-neutral-400 bg-none p-1.5 border-none absolute ",children:s?(0,t.jsx)("div",{className:c().loadingwheel+" bottom-2 right-3 absolute",children:(0,t.jsx)(LoadingDots,{color:"#003057"})}):(0,t.jsx)("svg",{viewBox:"0 0 20 20",className:c().svgicon,xmlns:"http://www.w3.org/2000/svg",children:(0,t.jsx)("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]}),(0,t.jsx)("div",{className:"w-full text-center text-xs italic text-gray-400 font-light",children:"I am an AI powered search tool, all data provided should be fact checked"})]})]})};var m=a(9169),u=a(5499),h=a(5299),g=a(7184),p=a(9307),f=a(6010),b=a(7851);function cn(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,b.m)((0,f.W)(s))}let j=g.fC,v=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,t.jsx)(g.ck,{ref:s,className:cn("border-b border-b-slate-200 dark:border-b-slate-700",a),...l})});v.displayName="AccordionItem";let w=l.forwardRef((e,s)=>{let{className:a,children:l,...r}=e;return(0,t.jsx)(g.h4,{className:"flex",children:(0,t.jsxs)(g.xz,{ref:s,className:cn("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",a),...r,children:[l,(0,t.jsx)(p.Z,{className:"h-4 w-4 transition-transform duration-200"})]})})});w.displayName=g.xz.displayName;let y=l.forwardRef((e,s)=>{let{className:a,children:l,...r}=e;return(0,t.jsx)(g.VY,{ref:s,className:cn("data-[state=open]:animate-accordion-down data-[state=closed]:animate-accordion-up overflow-hidden text-sm transition-all",a),...r,children:(0,t.jsx)("div",{className:"pt-0 pb-4",children:l})})});y.displayName=g.VY.displayName;let MessageContainer=e=>{let{loading:s,messageState:a}=e,r=(0,l.useRef)(null),{messages:i}=a;return(0,l.useEffect)(()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},[i]),(0,t.jsxs)("div",{className:"overflow-y-auto scroll-smooth scroll-pe-6 scroll-pb-5",children:[i.map((e,a)=>(0,t.jsxs)("div",{children:[(0,t.jsx)(MessageLine,{message:e,loading:s&&a===i.length-1}),e.sourceDocs&&e.sourceDocs.length>0&&(0,t.jsx)(SourceAccordion,{sourceDocs:e.sourceDocs,msgIdx:a})]},"chatMessage-".concat(a))),(0,t.jsx)("div",{ref:r,className:"h-0"})]})},MessageLine=e=>{let{message:s,loading:a}=e,l=a?c().usermessagewaiting+" flex":"bg-white p-6 flex",r="apiMessage"===s.type?"bg-ec-blue-50 p-6 flex":l;return(0,t.jsx)("div",{className:"border-b border-b-slate-200",children:(0,t.jsxs)("div",{className:"".concat(r," container"),children:["apiMessage"===s.type?(0,t.jsx)(m.Z,{className:"shrink-0 h-[24px] w-[24px] text-ec-blue-900 mr-3"}):(0,t.jsx)(u.Z,{className:"shrink-0 h-[24px] w-[24px] text-slate-800 mr-3"}),(0,t.jsx)("div",{className:c().markdownanswer+"",children:(0,t.jsx)(h.D,{linkTarget:"_blank",children:s.message})})]})})},SourceAccordion=e=>{let{sourceDocs:s,msgIdx:a}=e,r=(0,l.useRef)(null),i=function(e){let s=new Map;return e.forEach(e=>{let a=e.pageContent.toLowerCase();s.has(a)||s.set(a,e)}),Array.from(s.values())}(s);return(0,t.jsx)("div",{className:"",children:(0,t.jsx)(j,{type:"single",collapsible:!0,className:"bg-ec-grey-50 flex flex-col px-4",children:(0,t.jsxs)(v,{className:"",value:"item-".concat(a),children:[(0,t.jsx)(w,{className:"container",onClick:()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.scrollIntoView({behavior:"smooth"})},children:(0,t.jsx)("h3",{children:"Sources"})}),(0,t.jsx)(y,{className:"container",children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("ul",{className:"list-disc",children:i.map((e,s)=>{let a;return(0,t.jsxs)("li",{className:"flex flex-col mb-6",children:[(0,t.jsx)(h.D,{linkTarget:"_blank",children:((a=e.pageContent.replace(/\n+/g,"\n").replace(/[ \t]+/g," ").trim())&&!a.charAt(0).match(/[A-Z]/)&&(a="..."+a),a&&!a.endsWith(".")&&(a+="..."),a)}),(0,t.jsxs)("p",{className:"italic",children:[(0,t.jsx)("b",{children:"Source:"})," ",function(e){if("string"!=typeof e)return(0,t.jsx)("span",{children:"Source not available"});let s="https://www.electoralcommission.org.uk/",a=e.slice(0,-4).replace(/.*docs\/(batch_[0-9]\/)?/,"").replace(/_(.{15})$/,"").replace(/___/g,"/").replace(/__/g,"/"),l=a.split("/"),r=l.pop(),i=r&&15===r.length,n=i?s+l.join("/"):s+a;return(0,t.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",children:i?"PDF in page":n})}(e.metadata.source)]})]},"src-".concat(s))})}),(0,t.jsx)("div",{ref:r,className:"h-0"})]})})]})})},"sourceDocsAccordion-".concat(a))},initMessages=()=>[{message:"Hi! I'm the (unofficial) Electoral Commission chatbot, I search guidance documents so you donâ€™t have to",type:"apiMessage"},{message:"Remember the answers I provide are **not** legal advice. All data provided should be fact checked with The [Electoral Commission](https://www.electoralcommission.org.uk) tel: 0333 103 1928  \n    ![An anime meme where AI is asking if a butterfly is a pigeon](/ai-in-real-life.png)",type:"apiMessage"},{message:"Ask me a question! Here are some suggestions:  \n\n- How much money can I spend before I have to register?  \n- What are the spending limits for political parties?  \n- Do I need to register if I'm a charity distributing leaflets during an election?",type:"apiMessage"}];function Home(){let[e,s]=(0,l.useState)(!1),[a,r]=(0,l.useState)({messages:initMessages(),history:[]});return(0,t.jsxs)(Layout,{children:[(0,t.jsx)(MessageContainer,{loading:e,messageState:a}),(0,t.jsx)(MessageInput,{loading:e,setLoading:s,messageState:a,setMessageState:r})]})}},6612:function(e){e.exports={textarea:"Home_textarea__k243o",svgicon:"Home_svgicon__zEWsp",generatebutton:"Home_generatebutton__0PrxJ",messagelistloading:"Home_messagelistloading__AUUBn",usermessagewaiting:"Home_usermessagewaiting__SNXox","loading-gradient":"Home_loading-gradient__OUuLy",apimessage:"Home_apimessage___VZRe",fadein:"Home_fadein__qkFw_",markdownanswer:"Home_markdownanswer__MgsXp"}},6145:function(e){e.exports={loading:"loading-dots_loading__Ry98_",spacer:"loading-dots_spacer__Me41Y",blink:"loading-dots_blink__ATWnq",loading2:"loading-dots_loading2____Ssb"}}},function(e){e.O(0,[633,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);